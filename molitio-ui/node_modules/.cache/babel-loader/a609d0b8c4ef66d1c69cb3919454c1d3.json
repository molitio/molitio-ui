{"ast":null,"code":"import { __assign, __read, __spread } from \"tslib\";\nimport { useEffect, useState, useRef, useMemo } from 'react';\nimport classNames from 'classnames';\nimport { eventsMap } from './utils/events-map';\nimport { toCamel } from './utils/strings';\nimport { handleRef } from './component';\n\nvar reactPropFromEventName = function (evtName) {\n  return eventsMap[evtName] || evtName;\n};\n\nvar FoundationElement =\n/** @class */\nfunction () {\n  function FoundationElement(onChange) {\n    this._classes = new Set();\n    this._events = {};\n    this._style = {};\n    this._props = {};\n    this._ref = null;\n    this._onChange = null;\n    this._onChange = onChange;\n    this.onChange = this.onChange.bind(this);\n    this.addClass = this.addClass.bind(this);\n    this.removeClass = this.removeClass.bind(this);\n    this.hasClass = this.hasClass.bind(this);\n    this.setProp = this.setProp.bind(this);\n    this.getProp = this.getProp.bind(this);\n    this.removeProp = this.removeProp.bind(this);\n    this.setStyle = this.setStyle.bind(this);\n    this.addEventListener = this.addEventListener.bind(this);\n    this.removeEventListener = this.removeEventListener.bind(this);\n    this.setRef = this.setRef.bind(this);\n  }\n\n  FoundationElement.prototype.onChange = function () {\n    this._onChange && this._onChange();\n  };\n\n  FoundationElement.prototype.destroy = function () {\n    var _this = this;\n\n    this._onChange = null;\n    this._events = {};\n    this._style = {};\n    this._props = {};\n    this._classes = new Set();\n    setTimeout(function () {\n      _this._ref = null;\n    });\n  };\n  /**************************************************\n   * Classes\n   **************************************************/\n\n\n  FoundationElement.prototype.addClass = function (className) {\n    if (!this._classes.has(className)) {\n      this._classes.add(className);\n\n      this.onChange();\n    }\n  };\n\n  FoundationElement.prototype.removeClass = function (className) {\n    if (this._classes.has(className)) {\n      this._classes.delete(className);\n\n      this.onChange();\n    }\n  };\n\n  FoundationElement.prototype.hasClass = function (className) {\n    return this._classes.has(className);\n  };\n  /**************************************************\n   * Props\n   **************************************************/\n\n\n  FoundationElement.prototype.setProp = function (propName, value, silent) {\n    if (silent === void 0) {\n      silent = false;\n    }\n\n    if (this._props[propName] !== value) {\n      this._props[propName] = value;\n      !silent && this.onChange();\n    }\n  };\n\n  FoundationElement.prototype.getProp = function (propName) {\n    return this._props[propName];\n  };\n\n  FoundationElement.prototype.removeProp = function (propName) {\n    if (this._props[propName] !== undefined) {\n      delete this._props[propName];\n      this.onChange();\n    }\n  };\n\n  FoundationElement.prototype.props = function (propsToMerge) {\n    var _this = this;\n\n    var _a = propsToMerge.className,\n        className = _a === void 0 ? '' : _a,\n        _b = propsToMerge.style,\n        style = _b === void 0 ? {} : _b; // handle merging events\n    // the foundation should be able to pass something onClick as well as a user\n    // This wraps them in a function that calls both\n\n    var mergedEvents = Object.entries(propsToMerge).reduce(function (acc, _a) {\n      var _b = __read(_a, 2),\n          key = _b[0],\n          possibleCallback = _b[1];\n\n      var existingCallback = _this._events[key];\n\n      if (typeof possibleCallback === 'function' && typeof existingCallback === 'function') {\n        var wrappedCallback = function (evt) {\n          existingCallback(evt);\n          return possibleCallback(evt);\n        };\n\n        acc[key] = wrappedCallback;\n      }\n\n      return acc;\n    }, __assign({}, this._events)); // handle className\n\n    var mergedClasses = classNames(className, __spread(this._classes)); // handle styles\n\n    var mergedStyles = __assign(__assign({}, this._style), style);\n\n    return __assign(__assign(__assign(__assign({}, propsToMerge), this._props), mergedEvents), {\n      style: mergedStyles,\n      className: mergedClasses\n    });\n  };\n  /**************************************************\n   * Styles\n   **************************************************/\n\n\n  FoundationElement.prototype.setStyle = function (propertyName, value) {\n    propertyName = propertyName.startsWith('--') ? propertyName : toCamel(propertyName);\n\n    if (this._style[propertyName] !== value) {\n      this._style[propertyName] = value;\n      this.onChange();\n    }\n  };\n  /**************************************************\n   * Events\n   **************************************************/\n\n\n  FoundationElement.prototype.addEventListener = function (evtName, callback) {\n    var propName = reactPropFromEventName(evtName);\n\n    if (this._events[propName] !== callback) {\n      this._events[propName] = callback;\n      this.onChange();\n    }\n  };\n\n  FoundationElement.prototype.removeEventListener = function (evtName, callback) {\n    var propName = reactPropFromEventName(evtName);\n\n    if (this._events[propName]) {\n      delete this._events[propName];\n      this.onChange();\n    }\n  };\n  /**************************************************\n   * Refs\n   **************************************************/\n\n\n  FoundationElement.prototype.setRef = function (el) {\n    if (el) {\n      this._ref = el;\n    }\n  };\n\n  Object.defineProperty(FoundationElement.prototype, \"ref\", {\n    get: function () {\n      return this._ref;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return FoundationElement;\n}();\n\nexport { FoundationElement };\n\nvar emitFactory = function (props) {\n  return function (evtType, evtData, shouldBubble) {\n    if (shouldBubble === void 0) {\n      shouldBubble = false;\n    }\n\n    var evt;\n    evt = new CustomEvent(evtType, {\n      detail: evtData,\n      bubbles: shouldBubble\n    }); // bugfix for events coming from form elements\n    // and also fits with reacts form pattern better...\n    // This should always otherwise be null since there is no target\n    // for Custom Events\n\n    Object.defineProperty(evt, 'target', {\n      value: evtData,\n      writable: false\n    });\n    Object.defineProperty(evt, 'currentTarget', {\n      value: evtData,\n      writable: false\n    }); // Custom handling for React\n\n    var propName = evtType;\n    props[propName] && props[propName](evt);\n    return evt;\n  };\n};\n\nexport var useFoundation = function (_a) {\n  var foundationFactory = _a.foundation,\n      inputProps = _a.props,\n      elementsInput = _a.elements,\n      api = _a.api;\n\n  var _b = __read(useState(0), 2),\n      setIteration = _b[1];\n\n  var props = useRef(inputProps);\n  props.current = inputProps;\n  var elements = useMemo(function () {\n    return Object.keys(elementsInput).reduce(function (acc, key) {\n      acc[key] = new FoundationElement(function () {\n        setIteration(function (val) {\n          return val + 1;\n        });\n      });\n      return acc;\n    }, {});\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  []);\n  var foundation = useMemo(function () {\n    // init foundation\n    var f = foundationFactory(__assign(__assign({}, elements), {\n      getProps: function () {\n        return props.current;\n      },\n      emit: function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return emitFactory(props.current).apply(void 0, __spread(args));\n      }\n    })); // handle apiRefs\n\n    api && handleRef(props.current.apiRef, api(__assign({\n      foundation: f\n    }, elements)));\n    return f; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(function () {\n    var f = foundation;\n    f.init();\n    api && handleRef(props.current.apiRef, api(__assign({\n      foundation: f\n    }, elements)));\n    handleRef(props.current.foundationRef, f);\n    return function () {\n      f.destroy();\n      handleRef(props.current.apiRef, null);\n      handleRef(props.current.foundationRef, null);\n      Object.values(elements).map(function (element) {\n        return element.destroy();\n      }); // @ts-ignore\n\n      props.current = {};\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [foundation, elements]);\n  return __assign({\n    foundation: foundation\n  }, elements);\n};","map":{"version":3,"sources":["/Users/vycos-zen/git/molitio-workspace/molitio-ui/node_modules/@rmwc/base/next/foundation-component.js"],"names":["__assign","__read","__spread","useEffect","useState","useRef","useMemo","classNames","eventsMap","toCamel","handleRef","reactPropFromEventName","evtName","FoundationElement","onChange","_classes","Set","_events","_style","_props","_ref","_onChange","bind","addClass","removeClass","hasClass","setProp","getProp","removeProp","setStyle","addEventListener","removeEventListener","setRef","prototype","destroy","_this","setTimeout","className","has","add","delete","propName","value","silent","undefined","props","propsToMerge","_a","_b","style","mergedEvents","Object","entries","reduce","acc","key","possibleCallback","existingCallback","wrappedCallback","evt","mergedClasses","mergedStyles","propertyName","startsWith","callback","el","defineProperty","get","enumerable","configurable","emitFactory","evtType","evtData","shouldBubble","CustomEvent","detail","bubbles","writable","useFoundation","foundationFactory","foundation","inputProps","elementsInput","elements","api","setIteration","current","keys","val","f","getProps","emit","args","_i","arguments","length","apply","apiRef","init","foundationRef","values","map","element"],"mappings":"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","sourcesContent":["import { __assign, __read, __spread } from \"tslib\";\nimport { useEffect, useState, useRef, useMemo } from 'react';\nimport classNames from 'classnames';\nimport { eventsMap } from './utils/events-map';\nimport { toCamel } from './utils/strings';\nimport { handleRef } from './component';\nvar reactPropFromEventName = function (evtName) {\n    return eventsMap[evtName] || evtName;\n};\nvar FoundationElement = /** @class */ (function () {\n    function FoundationElement(onChange) {\n        this._classes = new Set();\n        this._events = {};\n        this._style = {};\n        this._props = {};\n        this._ref = null;\n        this._onChange = null;\n        this._onChange = onChange;\n        this.onChange = this.onChange.bind(this);\n        this.addClass = this.addClass.bind(this);\n        this.removeClass = this.removeClass.bind(this);\n        this.hasClass = this.hasClass.bind(this);\n        this.setProp = this.setProp.bind(this);\n        this.getProp = this.getProp.bind(this);\n        this.removeProp = this.removeProp.bind(this);\n        this.setStyle = this.setStyle.bind(this);\n        this.addEventListener = this.addEventListener.bind(this);\n        this.removeEventListener = this.removeEventListener.bind(this);\n        this.setRef = this.setRef.bind(this);\n    }\n    FoundationElement.prototype.onChange = function () {\n        this._onChange && this._onChange();\n    };\n    FoundationElement.prototype.destroy = function () {\n        var _this = this;\n        this._onChange = null;\n        this._events = {};\n        this._style = {};\n        this._props = {};\n        this._classes = new Set();\n        setTimeout(function () {\n            _this._ref = null;\n        });\n    };\n    /**************************************************\n     * Classes\n     **************************************************/\n    FoundationElement.prototype.addClass = function (className) {\n        if (!this._classes.has(className)) {\n            this._classes.add(className);\n            this.onChange();\n        }\n    };\n    FoundationElement.prototype.removeClass = function (className) {\n        if (this._classes.has(className)) {\n            this._classes.delete(className);\n            this.onChange();\n        }\n    };\n    FoundationElement.prototype.hasClass = function (className) {\n        return this._classes.has(className);\n    };\n    /**************************************************\n     * Props\n     **************************************************/\n    FoundationElement.prototype.setProp = function (propName, value, silent) {\n        if (silent === void 0) { silent = false; }\n        if (this._props[propName] !== value) {\n            this._props[propName] = value;\n            !silent && this.onChange();\n        }\n    };\n    FoundationElement.prototype.getProp = function (propName) {\n        return this._props[propName];\n    };\n    FoundationElement.prototype.removeProp = function (propName) {\n        if (this._props[propName] !== undefined) {\n            delete this._props[propName];\n            this.onChange();\n        }\n    };\n    FoundationElement.prototype.props = function (propsToMerge) {\n        var _this = this;\n        var _a = propsToMerge.className, className = _a === void 0 ? '' : _a, _b = propsToMerge.style, style = _b === void 0 ? {} : _b;\n        // handle merging events\n        // the foundation should be able to pass something onClick as well as a user\n        // This wraps them in a function that calls both\n        var mergedEvents = Object.entries(propsToMerge).reduce(function (acc, _a) {\n            var _b = __read(_a, 2), key = _b[0], possibleCallback = _b[1];\n            var existingCallback = _this._events[key];\n            if (typeof possibleCallback === 'function' &&\n                typeof existingCallback === 'function') {\n                var wrappedCallback = function (evt) {\n                    existingCallback(evt);\n                    return possibleCallback(evt);\n                };\n                acc[key] = wrappedCallback;\n            }\n            return acc;\n        }, __assign({}, this._events));\n        // handle className\n        var mergedClasses = classNames(className, __spread(this._classes));\n        // handle styles\n        var mergedStyles = __assign(__assign({}, this._style), style);\n        return __assign(__assign(__assign(__assign({}, propsToMerge), this._props), mergedEvents), { style: mergedStyles, className: mergedClasses });\n    };\n    /**************************************************\n     * Styles\n     **************************************************/\n    FoundationElement.prototype.setStyle = function (propertyName, value) {\n        propertyName = propertyName.startsWith('--')\n            ? propertyName\n            : toCamel(propertyName);\n        if (this._style[propertyName] !== value) {\n            this._style[propertyName] = value;\n            this.onChange();\n        }\n    };\n    /**************************************************\n     * Events\n     **************************************************/\n    FoundationElement.prototype.addEventListener = function (evtName, callback) {\n        var propName = reactPropFromEventName(evtName);\n        if (this._events[propName] !== callback) {\n            this._events[propName] = callback;\n            this.onChange();\n        }\n    };\n    FoundationElement.prototype.removeEventListener = function (evtName, callback) {\n        var propName = reactPropFromEventName(evtName);\n        if (this._events[propName]) {\n            delete this._events[propName];\n            this.onChange();\n        }\n    };\n    /**************************************************\n     * Refs\n     **************************************************/\n    FoundationElement.prototype.setRef = function (el) {\n        if (el) {\n            this._ref = el;\n        }\n    };\n    Object.defineProperty(FoundationElement.prototype, \"ref\", {\n        get: function () {\n            return this._ref;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return FoundationElement;\n}());\nexport { FoundationElement };\nvar emitFactory = function (props) { return function (evtType, evtData, shouldBubble) {\n    if (shouldBubble === void 0) { shouldBubble = false; }\n    var evt;\n    evt = new CustomEvent(evtType, {\n        detail: evtData,\n        bubbles: shouldBubble\n    });\n    // bugfix for events coming from form elements\n    // and also fits with reacts form pattern better...\n    // This should always otherwise be null since there is no target\n    // for Custom Events\n    Object.defineProperty(evt, 'target', {\n        value: evtData,\n        writable: false\n    });\n    Object.defineProperty(evt, 'currentTarget', {\n        value: evtData,\n        writable: false\n    });\n    // Custom handling for React\n    var propName = evtType;\n    props[propName] && props[propName](evt);\n    return evt;\n}; };\nexport var useFoundation = function (_a) {\n    var foundationFactory = _a.foundation, inputProps = _a.props, elementsInput = _a.elements, api = _a.api;\n    var _b = __read(useState(0), 2), setIteration = _b[1];\n    var props = useRef(inputProps);\n    props.current = inputProps;\n    var elements = useMemo(function () {\n        return Object.keys(elementsInput).reduce(function (acc, key) {\n            acc[key] = new FoundationElement(function () {\n                setIteration(function (val) { return val + 1; });\n            });\n            return acc;\n        }, {});\n    }, \n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []);\n    var foundation = useMemo(function () {\n        // init foundation\n        var f = foundationFactory(__assign(__assign({}, elements), { getProps: function () { return props.current; }, emit: function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                return emitFactory(props.current).apply(void 0, __spread(args));\n            } }));\n        // handle apiRefs\n        api && handleRef(props.current.apiRef, api(__assign({ foundation: f }, elements)));\n        return f;\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n    useEffect(function () {\n        var f = foundation;\n        f.init();\n        api && handleRef(props.current.apiRef, api(__assign({ foundation: f }, elements)));\n        handleRef(props.current.foundationRef, f);\n        return function () {\n            f.destroy();\n            handleRef(props.current.apiRef, null);\n            handleRef(props.current.foundationRef, null);\n            Object.values(elements).map(function (element) { return element.destroy(); });\n            // @ts-ignore\n            props.current = {};\n        };\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [foundation, elements]);\n    return __assign({ foundation: foundation }, elements);\n};\n"]},"metadata":{},"sourceType":"module"}